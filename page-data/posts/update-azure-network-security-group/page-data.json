{"componentChunkName":"component---src-templates-post-template-js","path":"/posts/update-azure-network-security-group/","result":{"data":{"markdownRemark":{"id":"9582848c-bf37-5c74-aac8-d50163afed02","html":"<p>azure VM에서 왠지 전체 22번 포트를 열자니 불안해서 내 로컬 머신 ip만 허용하는 스크립트 작성</p>\n<p>내 ip를 알기 위해서 shell에서 입력</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">curl</span> ifconfig.me\n<span class=\"token comment\">#203.203.23.23</span></code></pre></div>\n<p>혹시 설치 안되어있으면 설치 (ubuntu 기준)</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">sudo</span> <span class=\"token function\">apt</span> <span class=\"token function\">install</span> <span class=\"token function\">curl</span></code></pre></div>\n<p>az 명령어 사용할 수 있는 쉘에서 진행 (azure portal에서 cloud shell 같은.. 모바일 앱도 있음)</p>\n<p>처음 접속하는거면 network security group을 만들어 줘야 함</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">az network nsg rule create --name myssh --resource-group <span class=\"token punctuation\">{</span>리소스그룹이름<span class=\"token punctuation\">}</span> --source-address-prefixes <span class=\"token number\">203.203</span>.23.23 --source-port-ranges * --destination-address-prefixes * --destination-port-ranges <span class=\"token number\">22</span> -- --access Allow --protocol Tcp --priority <span class=\"token number\">1000</span> --description <span class=\"token string\">\"Allow only ssh from my local to vm\"</span></code></pre></div>\n<p>이미 만들어져 있으면, 이름과 network security group과 리소스 그룹을 지정해 주면 소스 ip를 업데이트 할 수 있음</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">az network nsg rule update --name myssh --nsg-name <span class=\"token punctuation\">{</span>NSG이름<span class=\"token punctuation\">}</span> --resource-group <span class=\"token punctuation\">{</span>리소스그룹이름<span class=\"token punctuation\">}</span> --source-address-prefixes <span class=\"token number\">203.203</span>.23.23</code></pre></div>","fields":{"slug":"/posts/update-azure-network-security-group/","tagSlugs":["/tag/azure/"]},"frontmatter":{"date":"2019-08-14T00:00:00.000Z","description":"특정 ip만 22번 포트를 열기 위해서 security group을 cli를 통해 변경","tags":["Azure"],"title":"update azure network security group cli","socialImage":null}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/posts/update-azure-network-security-group/"}}}